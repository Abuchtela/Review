import { VulnerabilityDetail } from "@/types";

interface VulnerabilityExplanationProps {
  vulnerability: VulnerabilityDetail;
}

const VulnerabilityExplanation = ({ vulnerability }: VulnerabilityExplanationProps) => {
  return (
    <div className="mt-8 bg-[#242424] rounded-lg p-6">
      <h3 className="text-lg font-medium mb-4">Vulnerability Explanation</h3>
      
      <div className="space-y-4 text-gray-300">
        <p>
          {vulnerability.explanation}
        </p>
        
        <p className="mt-4 font-medium">Key Vulnerability Points:</p>
        <ul className="list-disc list-inside space-y-2 ml-4">
          {vulnerability.keyPoints.map((point, index) => (
            <li key={index}>
              {point.includes('`') 
                ? <span dangerouslySetInnerHTML={{ 
                    __html: point.replace(/`([^`]+)`/g, '<code class="bg-[#1E1E1E] px-1 rounded">$1</code>') 
                  }} />
                : point
              }
            </li>
          ))}
        </ul>
        
        <p className="mt-4 font-medium">Recommended Fixes:</p>
        <ul className="list-disc list-inside space-y-2 ml-4">
          {vulnerability.recommendations.map((rec, index) => (
            <li key={index}>{rec}</li>
          ))}
        </ul>
        
        {vulnerability.securityInsight && (
          <div className="bg-blue-900/30 border border-blue-700/30 rounded-md p-4 mt-4">
            <p className="text-blue-300 font-medium">Security Insight:</p>
            <p className="mt-2 text-blue-100">
              {vulnerability.securityInsight}
            </p>
          </div>
        )}
      </div>
    </div>
  );
};

export default VulnerabilityExplanation;
